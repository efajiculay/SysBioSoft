<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module BioSANS2020.model.param_est.my_mcem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="BioSANS2020.html"><font color="#ffffff">BioSANS2020</font></a>.<a href="BioSANS2020.model.html"><font color="#ffffff">model</font></a>.<a href="BioSANS2020.model.param_est.html"><font color="#ffffff">param_est</font></a>.my_mcem</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:c%3A%5Cusers%5Cerickson%5Cdesktop%5Cbiosans%5Csrc%5Cbiosans2020%5Cmodel%5Cparam_est%5Cmy_mcem.py">c:\users\erickson\desktop\biosans\src\biosans2020\model\param_est\my_mcem.py</a></font></td></tr></table>
    <p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;module&nbsp;is&nbsp;the&nbsp;my_mcem&nbsp;module<br>
&nbsp;<br>
This&nbsp;module&nbsp;is&nbsp;a&nbsp;simple&nbsp;implementation&nbsp;of&nbsp;monte-carlo&nbsp;expectation&nbsp;maximi<br>
zation.&nbsp;The&nbsp;likelihood&nbsp;&nbsp;function&nbsp;here&nbsp;is&nbsp;the&nbsp;joint&nbsp;probability&nbsp;distribu-<br>
tion&nbsp;of&nbsp;the&nbsp;&nbsp;error&nbsp;or&nbsp;&nbsp;the&nbsp;difference&nbsp;between&nbsp;the&nbsp;true&nbsp;value&nbsp;and&nbsp;estima-<br>
ted&nbsp;value.&nbsp;The&nbsp;error&nbsp;on&nbsp;each&nbsp;parameter&nbsp;estimate&nbsp;&nbsp;is&nbsp;assumed&nbsp;to&nbsp;&nbsp;be&nbsp;inde-<br>
pendent&nbsp;and&nbsp;follows&nbsp;a&nbsp;normal&nbsp;&nbsp;distribution.&nbsp;A&nbsp;uniform&nbsp;prior&nbsp;was&nbsp;set.&nbsp;The<br>
log-likelihood&nbsp;&nbsp;of&nbsp;&nbsp;this&nbsp;function&nbsp;becomes&nbsp;the&nbsp;negative&nbsp;of&nbsp;the&nbsp;sum&nbsp;of&nbsp;the<br>
squared&nbsp;&nbsp;error&nbsp;&nbsp;between&nbsp;&nbsp;the&nbsp;&nbsp;estimated&nbsp;value&nbsp;and&nbsp;true&nbsp;value.&nbsp;Parameters<br>
were&nbsp;drawn&nbsp;&nbsp;from&nbsp;&nbsp;a&nbsp;log-normal&nbsp;distribution.&nbsp;In&nbsp;our&nbsp;&nbsp;implementation,&nbsp;the<br>
posterior&nbsp;&nbsp;probability&nbsp;&nbsp;is&nbsp;&nbsp;calculated&nbsp;at&nbsp;each&nbsp;sampling&nbsp;&nbsp;stage.&nbsp;&nbsp;In&nbsp;&nbsp;the<br>
maximization&nbsp;step,&nbsp;the&nbsp;&nbsp;ratio&nbsp;of&nbsp;posterior&nbsp;&nbsp;probability&nbsp;between&nbsp;consecu-<br>
tive&nbsp;draws&nbsp;(or&nbsp;the&nbsp;exponential&nbsp;of&nbsp;the&nbsp;difference&nbsp;between&nbsp;consecutive&nbsp;log<br>
-likelihood)&nbsp;are&nbsp;&nbsp;used&nbsp;to&nbsp;decide&nbsp;&nbsp;whether&nbsp;to&nbsp;accept&nbsp;or&nbsp;reject&nbsp;the&nbsp;latest<br>
values&nbsp;of&nbsp;the&nbsp;parameters&nbsp;based&nbsp;on&nbsp;a&nbsp;uniform&nbsp;random&nbsp;variable.&nbsp;After&nbsp;seve-<br>
ral&nbsp;samplings&nbsp;&nbsp;(decided&nbsp;programmatically&nbsp;in&nbsp;the&nbsp;algorithm),&nbsp;the&nbsp;mean&nbsp;and<br>
standard&nbsp;deviation&nbsp;of&nbsp;the&nbsp;parameters&nbsp;&nbsp;from&nbsp;all&nbsp;&nbsp;the&nbsp;accepted&nbsp;&nbsp;values&nbsp;are<br>
calculated&nbsp;&nbsp;and&nbsp;&nbsp;used&nbsp;as&nbsp;the&nbsp;mean&nbsp;&nbsp;and&nbsp;standard&nbsp;&nbsp;deviation&nbsp;&nbsp;for&nbsp;the&nbsp;next<br>
sampling&nbsp;&nbsp;stage.&nbsp;&nbsp;This&nbsp;serves&nbsp;as&nbsp;the&nbsp;expectation&nbsp;step&nbsp;in&nbsp;our&nbsp;implementa-<br>
tion&nbsp;because&nbsp;we&nbsp;&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;&nbsp;close&nbsp;form&nbsp;for&nbsp;the&nbsp;parameters.&nbsp;The&nbsp;cycle<br>
is&nbsp;repeated&nbsp;until&nbsp;&nbsp;the&nbsp;calculated&nbsp;&nbsp;mean&nbsp;and&nbsp;&nbsp;standard&nbsp;deviations&nbsp;of&nbsp;each<br>
parameters&nbsp;are&nbsp;no&nbsp;longer&nbsp;changing&nbsp;or&nbsp;&nbsp;until&nbsp;&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;steps<br>
is&nbsp;reached.<br>
&nbsp;<br>
The&nbsp;following&nbsp;are&nbsp;the&nbsp;functions&nbsp;inside&nbsp;this&nbsp;module<br>
&nbsp;<br>
1.&nbsp;log_likelihood<br>
2.&nbsp;cost_value<br>
3.&nbsp;exptn_maxtn<br>
4.&nbsp;run_mcem</tt></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="numpy.html">numpy</a><br>
</td><td width="25%" valign=top><a href="BioSANS2020.myglobal.proc_global.html">BioSANS2020.myglobal.proc_global</a><br>
</td><td width="25%" valign=top><a href="warnings.html">warnings</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-cost_value"><strong>cost_value</strong></a>(ks_var, custom_function, args=None)</dt><dd><tt>This&nbsp;function&nbsp;&nbsp;evaluates&nbsp;&nbsp;the&nbsp;cost&nbsp;value&nbsp;or&nbsp;SSE&nbsp;of&nbsp;the&nbsp;definitons<br>
provided&nbsp;in&nbsp;the&nbsp;custom_function.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ks_var&nbsp;(list):&nbsp;list&nbsp;of&nbsp;parameter&nbsp;values<br>
&nbsp;&nbsp;&nbsp;&nbsp;custom_function&nbsp;(function):&nbsp;user/program&nbsp;defined&nbsp;objective/error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;&nbsp;to&nbsp;&nbsp;optimized&nbsp;&nbsp;my&nbsp;&nbsp;expectation&nbsp;&nbsp;maximization&nbsp;or&nbsp;EM<br>
&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;(tuple):&nbsp;Tuple&nbsp;&nbsp;of&nbsp;&nbsp;(data,&nbsp;&nbsp;conc,&nbsp;tvar,&nbsp;&nbsp;sp_comp,&nbsp;&nbsp;ks_dict,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_dict,&nbsp;&nbsp;p_dict,&nbsp;&nbsp;v_stoich,&nbsp;&nbsp;c_miss,&nbsp;&nbsp;k_miss,&nbsp;molar,&nbsp;rfile).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;&nbsp;to&nbsp;None.&nbsp;See&nbsp;param_estimate&nbsp;module&nbsp;for&nbsp;&nbsp;the&nbsp;proper<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition&nbsp;of&nbsp;variables.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;float:&nbsp;numeric&nbsp;value&nbsp;of&nbsp;custom_function(ks_var,&nbsp;args)</tt></dd></dl>
 <dl><dt><a name="-exptn_maxtn"><strong>exptn_maxtn</strong></a>(lst, seed_var, maxiter=50, inner_loop=1000, lenks=3, positive_only=False, likelihood=None, args=None, thr=1e-10)</dt><dd><tt>This&nbsp;&nbsp;function&nbsp;&nbsp;performs&nbsp;&nbsp;the&nbsp;&nbsp;expectation&nbsp;&nbsp;step&nbsp;and&nbsp;maximization<br>
steps&nbsp;&nbsp;bounded&nbsp;by&nbsp;&nbsp;maxiter&nbsp;and&nbsp;inner_loop&nbsp;&nbsp;variables.&nbsp;The&nbsp;process&nbsp;is<br>
similar&nbsp;to&nbsp;the&nbsp;metrololis&nbsp;&nbsp;hasting&nbsp;algorithm.&nbsp;There&nbsp;is&nbsp;a&nbsp;random&nbsp;walk<br>
performed&nbsp;as&nbsp;the&nbsp;&nbsp;posterior&nbsp;probability&nbsp;is&nbsp;maximized.&nbsp;The&nbsp;parameters<br>
are&nbsp;updated&nbsp;in&nbsp;the&nbsp;randomwalk&nbsp;based&nbsp;on&nbsp;sampled&nbsp;values.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;lst&nbsp;(multiprocessing.managers.ListProxy):<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;multiprocessing.Manager()&nbsp;from&nbsp;proc_global&nbsp;module.&nbsp;This&nbsp;help<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;halting&nbsp;simulation&nbsp;when&nbsp;one&nbsp;of&nbsp;the&nbsp;chains&nbsp;already&nbsp;achived<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;defined&nbsp;tolerance.<br>
&nbsp;&nbsp;&nbsp;&nbsp;seed_var&nbsp;(float):&nbsp;random&nbsp;&nbsp;seed&nbsp;&nbsp;value&nbsp;picked&nbsp;&nbsp;at&nbsp;random&nbsp;for&nbsp;each<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;trajectory.&nbsp;They&nbsp;have&nbsp;been&nbsp;sampled&nbsp;from&nbsp;the&nbsp;calling&nbsp;program.<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxiter&nbsp;(int,&nbsp;optional):&nbsp;&nbsp;maximum&nbsp;&nbsp;number&nbsp;&nbsp;of&nbsp;expectation&nbsp;steps.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;to&nbsp;50.&nbsp;This&nbsp;is&nbsp;the&nbsp;outer&nbsp;loop.<br>
&nbsp;&nbsp;&nbsp;&nbsp;inner_loop&nbsp;(int,&nbsp;optional):&nbsp;maximum&nbsp;number&nbsp;of&nbsp;maximization&nbsp;step.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;to&nbsp;1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;lenks&nbsp;(int,&nbsp;optional):&nbsp;numbers&nbsp;&nbsp;unknown&nbsp;&nbsp;parameters&nbsp;to&nbsp;estimate.<br>
&nbsp;&nbsp;&nbsp;&nbsp;positive_only&nbsp;(bool,&nbsp;optional):&nbsp;constraint&nbsp;the&nbsp;parameter&nbsp;estima-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tion&nbsp;to&nbsp;choose&nbsp;positive&nbsp;values.&nbsp;Defaults&nbsp;to&nbsp;False.<br>
&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;(function,&nbsp;optional):&nbsp;user/program&nbsp;defined&nbsp;objective/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;function&nbsp;&nbsp;to&nbsp;&nbsp;optimized<br>
&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;(tuple):&nbsp;Tuple&nbsp;&nbsp;of&nbsp;&nbsp;(data,&nbsp;&nbsp;conc,&nbsp;tvar,&nbsp;&nbsp;sp_comp,&nbsp;&nbsp;ks_dict,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_dict,&nbsp;&nbsp;p_dict,&nbsp;&nbsp;v_stoich,&nbsp;&nbsp;c_miss,&nbsp;&nbsp;k_miss,&nbsp;molar,&nbsp;rfile).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;&nbsp;to&nbsp;None.&nbsp;See&nbsp;param_estimate&nbsp;module&nbsp;for&nbsp;&nbsp;the&nbsp;proper<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition&nbsp;of&nbsp;variables.<br>
&nbsp;&nbsp;&nbsp;&nbsp;thr&nbsp;(function,&nbsp;optional):&nbsp;error&nbsp;tolerance.&nbsp;Defaults&nbsp;to&nbsp;1.0e-10.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;tuple:&nbsp;(list&nbsp;of&nbsp;estimated&nbsp;parameter,&nbsp;minimum&nbsp;error)</tt></dd></dl>
 <dl><dt><a name="-log_likelihood"><strong>log_likelihood</strong></a>(ks_var, custom_function, args=None)</dt><dd><tt>This&nbsp;function&nbsp;evaluates&nbsp;the&nbsp;loglikelihood&nbsp;based&nbsp;on&nbsp;the&nbsp;definitons<br>
provided&nbsp;in&nbsp;the&nbsp;custom_function.&nbsp;Here,&nbsp;it&nbsp;is&nbsp;the&nbsp;negative&nbsp;of&nbsp;the&nbsp;sum<br>
of&nbsp;squared&nbsp;errors&nbsp;between&nbsp;true&nbsp;and&nbsp;estimated&nbsp;value.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;ks_var&nbsp;(list):&nbsp;list&nbsp;of&nbsp;parameter&nbsp;values<br>
&nbsp;&nbsp;&nbsp;&nbsp;custom_function&nbsp;(function):&nbsp;user/program&nbsp;defined&nbsp;objective/error<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function&nbsp;&nbsp;to&nbsp;&nbsp;optimized&nbsp;&nbsp;my&nbsp;expectation&nbsp;&nbsp;maximization&nbsp;&nbsp;or&nbsp;EM<br>
&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;(tuple):&nbsp;Tuple&nbsp;&nbsp;of&nbsp;&nbsp;(data,&nbsp;&nbsp;conc,&nbsp;tvar,&nbsp;&nbsp;sp_comp,&nbsp;&nbsp;ks_dict,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_dict,&nbsp;&nbsp;p_dict,&nbsp;&nbsp;v_stoich,&nbsp;&nbsp;c_miss,&nbsp;&nbsp;k_miss,&nbsp;molar,&nbsp;rfile).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;&nbsp;to&nbsp;None.&nbsp;See&nbsp;param_estimate&nbsp;module&nbsp;for&nbsp;&nbsp;the&nbsp;proper<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition&nbsp;of&nbsp;variables.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;float:&nbsp;numeric&nbsp;value&nbsp;of&nbsp;custom_function(ks_var,&nbsp;args)</tt></dd></dl>
 <dl><dt><a name="-run_mcem"><strong>run_mcem</strong></a>(chains, n_pars, maxiter=5, inner_loop=5000, positive_only=False, likelihood=None, arg=None, r_rand=0.18777860859927897)</dt><dd><tt>[summary]<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;chains&nbsp;(integer):&nbsp;number&nbsp;of&nbsp;parallel&nbsp;runs&nbsp;or&nbsp;chains<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_pars&nbsp;(integer):&nbsp;number&nbsp;of&nbsp;parameters<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxiter&nbsp;(int,&nbsp;optional):&nbsp;&nbsp;maximum&nbsp;&nbsp;number&nbsp;&nbsp;of&nbsp;expectation&nbsp;steps.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;to&nbsp;50.&nbsp;This&nbsp;is&nbsp;the&nbsp;outer&nbsp;loop.<br>
&nbsp;&nbsp;&nbsp;&nbsp;inner_loop&nbsp;(int,&nbsp;optional):&nbsp;maximum&nbsp;number&nbsp;of&nbsp;maximization&nbsp;step.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;to&nbsp;1000.<br>
&nbsp;&nbsp;&nbsp;&nbsp;positive_only&nbsp;(bool,&nbsp;optional):&nbsp;constraint&nbsp;the&nbsp;parameter&nbsp;estima-<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tion&nbsp;to&nbsp;choose&nbsp;positive&nbsp;values.&nbsp;Defaults&nbsp;to&nbsp;False.<br>
&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;(function,&nbsp;optional):&nbsp;user/program&nbsp;defined&nbsp;objective/<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;function&nbsp;&nbsp;to&nbsp;&nbsp;optimized<br>
&nbsp;&nbsp;&nbsp;&nbsp;args&nbsp;(tuple):&nbsp;Tuple&nbsp;&nbsp;of&nbsp;&nbsp;(data,&nbsp;&nbsp;conc,&nbsp;tvar,&nbsp;&nbsp;sp_comp,&nbsp;&nbsp;ks_dict,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r_dict,&nbsp;&nbsp;p_dict,&nbsp;&nbsp;v_stoich,&nbsp;&nbsp;c_miss,&nbsp;&nbsp;k_miss,&nbsp;molar,&nbsp;rfile).<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Defaults&nbsp;&nbsp;to&nbsp;None.&nbsp;See&nbsp;param_estimate&nbsp;module&nbsp;for&nbsp;&nbsp;the&nbsp;proper<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;definition&nbsp;of&nbsp;variables.<br>
&nbsp;&nbsp;&nbsp;&nbsp;r_rand&nbsp;(float,&nbsp;optional):&nbsp;np.random.uniform(0,&nbsp;1)&nbsp;for&nbsp;seeding<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;[type]:&nbsp;[description]</tt></dd></dl>
</td></tr></table>
</body></html>